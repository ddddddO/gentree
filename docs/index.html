<html>
 
<head prefix="og: https://ogp.me/ns#">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="Output tree from Markdown. 手作業で枝を組み立てるのは面倒、楽にツリーを組み立てたい時に役に立ちます。また、このページは https://github.com/ddddddO/gtree のライブラリを Wasm 化して呼び出しています。このリポジトリには、当該ライブラリの他に、別機能・別用途のCLIツールとライブラリを提供しています。"/>
    <!-- テーマカラー -->
    <meta name="theme-color" content="#134e4a">
    <!-- テーマカラー　モード指定 -->
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#134e4a">
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#134e4a">

    <meta property="og:url" content="https://ddddddo.github.io/gtree/" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Tree Maker" />
    <meta property="og:description" content="Output tree from Markdown. 手作業で枝を組み立てるのは面倒、楽にツリーを組み立てたい時に役に立ちます。また、このページは https://github.com/ddddddO/gtree のライブラリを Wasm 化して呼び出しています。このリポジトリには、当該ライブラリの他に、別機能・別用途のCLIツールとライブラリを提供しています。" />
    <meta property="og:site_name" content="Tree Maker" />

    <!-- favicon.svg -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🌴</text></svg>">

    <title>Tree Maker</title>

    <script src="https://cdn.tailwindcss.com?plugins=forms,aspect-ratio"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-94DG34ENH8"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-94DG34ENH8');
    </script>
</head>
 
<body class="bg-teal-900 text-white px-6 py-4">
    <script src="./wasm_exec.js"></script>
    <script>
        const go = new Go();
        let mod, instance;
        WebAssembly.instantiateStreaming(fetch("main.wasm"), go.importObject).then((result) => {
            mod = result.module;
            instance = result.instance;
            document.getElementById("gtree").disabled = false;

            console.clear();
            go.run(instance);
            instance = WebAssembly.instantiate(mod, go.importObject);
        });

        const clearMarkdown = () => {
          document.getElementById("in").value = "";
          gtag('event', 'clear button', {'event_category': 'clear button','event_label': 'button click'});
        };

        const generateTree = () => {
          gtree();
          gtag('event', 'tree button', {'event_category': 'tree button','event_label': 'button click'});
        };

        const copyToClipboard = () => {
          const tree = document.getElementById("treeView");
          if (tree === null) {
            return;
          }
          const clipboard = window.navigator.clipboard;
          clipboard.writeText(tree.innerHTML);

          gtag('event', 'copy button', {'event_category': 'copy button','event_label': 'button click'});
        };
    </script>

    <h1 class="text-3xl font-bold">
      Tree Maker <a class="underline text-sm" href="https://github.com/ddddddO/gtree" onclick="gtag('event', 'to github link', {'event_category': 'github link','event_label': 'link access'});">GitHub</a>
    </h1>

    <div>
      <textarea class="bg-teal-800 rounded-md mt-1 w-full h-64" id="in" spellcheck="false">- Primate
  - Strepsirrhini
    - Lemuriformes
      - Lemuroidea
        - Cheirogaleidae
        - Indriidae
        - Lemuridae
        - Lepilemuridae
      - Daubentonioidea
        - Daubentoniidae
    - Lorisiformes
      - Galagidae
      - Lorisidae
  - Haplorrhini
    - Tarsiiformes
      - Tarsiidae
    - Simiiformes
      - Platyrrhini
        - Ceboidea
          - Atelidae
          - Cebidae
        - Pithecioidea
          - Pitheciidae
      - Catarrhini
        - Cercopithecoidea
          - Cercopithecidae
        - Hominoidea
          - Hylobatidae
          - Hominidae</textarea>

      <button class="hover:outline rounded bg-cyan-600 shadow-xl px-1 mt-2" onClick="clearMarkdown();" id="clearMarkdown">clear</button>

      <div class="mt-4">
        Parts</br>
        <input class="bg-teal-800 rounded-lg w-1/5" type="text" id="parts1" value="└">
        <input class="bg-teal-800 rounded-lg w-1/5" type="text" id="parts2" value="├">
        <input class="bg-teal-800 rounded-lg w-1/5" type="text" id="parts3" value="──">
        <input class="bg-teal-800 rounded-lg w-1/5" type="text" id="parts4" value="│">
      </div>

      <div>
        <button class="hover:outline rounded bg-teal-600 shadow-xl px-1 mt-4 mb-2" onClick="generateTree();" id="gtree" disabled>tree!</button>
        <button class="hover:outline rounded bg-teal-600 shadow-xl px-1 mt-4 mb-2" onClick="copyToClipboard();" id="copy">copy</button>
        <div id="toast"></div>
      </div>
    </div>

    <!-- referred to https://codepen.io/kandai/pen/qBEbgQv -->
    <style>
      #toast {
        max-width: 75px;
        padding: 3px;
        border-radius: 5%;
        position:absolute;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      #toast.is-success {
        background-color: rgb(20 184 166);
      }
      #toast.is-show {
        animation: anime 1.5s ease 1 normal;
      }

      @keyframes anime {
        from { transform: translateY(-10%); }
        to { transform: translateY(30%); }
      }
    </style>

    <script>
      const toast = document.getElementById("toast");
      let isVisible = false;

      const showToast = (status, message) => {
          if (isVisible) return false

          toast.innerHTML = message
          toast.classList.add('is-' + status)
          toast.classList.add('is-show')
          isVisible = true
      };

      toast.addEventListener("animationend", () => {
          toast.innerHTML = "";
          toast.className = "init";
          isVisible = false;
      });

      document.getElementById("copy").addEventListener("click", (ev) => {
        showToast("success", "Copied!")
      });
    </script>
</body>
 
</html>